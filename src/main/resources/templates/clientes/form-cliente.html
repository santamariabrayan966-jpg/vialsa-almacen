<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="formCliente">

    <form th:action="@{/clientes/guardar}"
          th:object="${cliente}"
          method="post"
          enctype="multipart/form-data">

        <!-- ID OCULTO -->
        <input type="hidden" th:field="*{idClientes}"/>

        <!-- ERRORES GLOBALES (por ejemplo, duplicado u otros) -->
        <div class="alert alert-danger py-2"
             th:if="${#fields.hasGlobalErrors()}">
            <ul class="mb-0">
                <li th:each="err : ${#fields.globalErrors()}"
                    th:text="${err}"></li>
            </ul>
        </div>

        <div class="row g-3">

            <!-- FOTO -->
            <div class="col-12 text-center mb-3">
                <img id="foto-preview"
                     th:src="${cliente.foto != null}
            ? @{/uploads/{f}(f=${cliente.foto})}
            : @{/images/default-user.png}">

                <br>
                <label class="btn btn-outline-primary btn-sm mt-2">
                    Subir Foto
                    <input type="file" name="fileFoto" id="fotoFile" hidden>
                </label>
            </div>

            <!-- DNI -->
            <div class="mb-3">
                <label class="form-label">DNI</label>
                <div class="input-group">
                    <input type="text"
                           id="dniCliente"
                           th:field="*{nro_documento}"
                           class="form-control"
                           maxlength="8"
                           placeholder="DNI del cliente">

                    <button type="button"
                            class="btn btn-outline-secondary"
                            id="btnBuscarDniCliente">
                        <i class="bi bi-search"></i> Buscar DNI
                    </button>
                </div>

                <!-- error específico del DNI -->
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('nro_documento')}"
                     th:errors="*{nro_documento}">
                    <!-- aquí Thymeleaf pinta el mensaje -->
                </div>
            </div>

            <!-- NOMBRES -->
            <div class="mb-3">
                <label class="form-label">Nombres</label>
                <input type="text"
                       id="nombresCliente"
                       th:field="*{nombres}"
                       class="form-control">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('nombres')}"
                     th:errors="*{nombres}"></div>
            </div>

            <!-- APELLIDOS -->
            <div class="mb-3">
                <label class="form-label">Apellidos</label>
                <input type="text"
                       id="apellidosCliente"
                       th:field="*{apellidos}"
                       class="form-control">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('apellidos')}"
                     th:errors="*{apellidos}"></div>
            </div>

            <!-- Correo -->
            <div class="col-md-6">
                <label class="form-label">Correo</label>
                <input type="email" class="form-control"
                       th:field="*{correo}">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('correo')}"
                     th:errors="*{correo}"></div>
            </div>

            <!-- Teléfono -->
            <div class="col-md-6">
                <label class="form-label">Teléfono</label>
                <input type="text" class="form-control"
                       th:field="*{telefono}">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('telefono')}"
                     th:errors="*{telefono}"></div>
            </div>

            <!-- DIRECCIÓN -->
            <div class="mb-3">
                <label class="form-label">Dirección</label>
                <input type="text"
                       id="direccionCliente"
                       th:field="*{direccion}"
                       class="form-control">
                <div class="text-danger small"
                     th:if="${#fields.hasErrors('direccion')}"
                     th:errors="*{direccion}"></div>
            </div>

            <!-- Estado -->
            <div class="col-12 col-md-6">
                <label class="form-label">Estado</label>
                <select class="form-select" th:field="*{activo}">
                    <option th:value="true">Activo</option>
                    <option th:value="false">Inactivo</option>
                </select>
            </div>

        </div>

        <div class="text-end mt-3">
            <button class="btn btn-primary px-4">
                Guardar
            </button>
        </div>

    </form>

</div>

</body>
</html>
