<header th:fragment="header"
        xmlns:th="http://www.thymeleaf.org"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

    <nav class="navbar navbar-expand-lg navbar-dark"
         style="background: linear-gradient(90deg, #283E81, #A73C3C);">
        <div class="container-fluid">

            <!-- üî∑ Logo -->
            <a class="navbar-brand fw-bold text-white" th:href="@{/}">
                <i class="bi bi-box"></i> VIALSA
            </a>

            <!-- üî∏ Bot√≥n colapsable -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav" aria-controls="navbarNav"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- üîπ Men√∫ principal -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">

                    <!-- üåê Productos -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'productos')}">
                        <a class="nav-link text-light" th:href="@{/productos}">
                            <i class="bi bi-bag"></i> Productos
                        </a>
                    </li>

                    <!-- üßë‚Äçü§ù‚Äçüßë Usuarios -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'usuarios')}">
                        <a class="nav-link text-light" th:href="@{/usuarios}">
                            <i class="bi bi-people"></i> Usuarios
                        </a>
                    </li>

                    <!-- üõí Compras -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'compras')}">
                        <a class="nav-link text-light" th:href="@{/compras}">
                            <i class="bi bi-cart"></i> Compras
                        </a>
                    </li>

                    <!-- üßæ Ventas -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'ventas')}">
                        <a class="nav-link text-light" th:href="@{/ventas}">
                            <i class="bi bi-receipt"></i> Ventas
                        </a>
                    </li>

                    <!-- üì¶ Inventario -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'inventario')}">
                        <a class="nav-link text-light" th:href="@{/inventario}">
                            <i class="bi bi-box-seam"></i> Inventario
                        </a>
                    </li>

                    <!-- üìä Dashboard -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'dashboard')}">
                        <a class="nav-link text-light" th:href="@{/dashboard}">
                            <i class="bi bi-speedometer2"></i> Dashboard
                        </a>
                    </li>

                    <!-- üõ° Roles -->
                    <li class="nav-item"
                        th:if="${@authService.tieneAcceso(#authentication, 'roles')}">
                        <a class="nav-link text-light" th:href="@{/roles}">
                            <i class="bi bi-shield-lock"></i> Roles
                        </a>
                    </li>

                    <!-- üë§ Usuario (solo nombre) -->
                    <li class="nav-item d-flex align-items-center"
                        sec:authorize="isAuthenticated()">
                        <span class="navbar-text text-white me-2">
                            <i class="bi bi-person-circle"></i>
                            <span sec:authentication="name"></span>
                        </span>
                    </li>

                    <!-- üî¥ Bot√≥n Cerrar sesi√≥n (√öNICO logout) -->
                    <li class="nav-item" sec:authorize="isAuthenticated()">
                        <form th:action="@{/logout}" method="post" class="d-inline">
                            <button type="submit"
                                    class="nav-link btn btn-link text-danger fw-semibold">
                                <i class="bi bi-box-arrow-right"></i> Cerrar sesi√≥n
                            </button>
                        </form>
                    </li>

                    <!-- üîì Login (solo si NO est√° autenticado) -->
                    <li class="nav-item" sec:authorize="!isAuthenticated()">
                        <a class="nav-link text-light" th:href="@{/login}">
                            <i class="bi bi-box-arrow-in-right"></i> Iniciar sesi√≥n
                        </a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>
</header>
