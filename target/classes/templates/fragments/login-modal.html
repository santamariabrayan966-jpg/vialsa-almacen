<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="loginModal">

    <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm modal-md modal-lg">
            <div class="modal-content login-modal-content">

                <div class="modal-body">

                    <!-- CABECERA -->
                    <div class="text-center mb-3">
                        <img th:src="@{/images/logovialsa.png}" width="70" class="rounded-circle" alt="Logo Vialsa">
                        <h4 class="mt-2 mb-0">VIALSA</h4>
                        <p class="text-muted mb-2">Iniciar sesión / Registrarse</p>
                    </div>

                    <!-- NAV TABS -->
                    <ul class="nav nav-tabs mb-3 justify-content-center" id="loginTabs">
                        <li class="nav-item">
                            <a class="nav-link"
                               th:classappend="${mostrarRegistro == null or !mostrarRegistro} ? ' active'"
                               href="#"
                               onclick="mostrarLogin(); return false;">
                                Iniciar sesión
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                               th:classappend="${mostrarRegistro != null and mostrarRegistro} ? ' active'"
                               href="#"
                               onclick="mostrarRegistro(); return false;">
                                Registrarme
                            </a>
                        </li>
                    </ul>

                    <!-- ============================== -->
                    <!--           VISTA LOGIN          -->
                    <!-- ============================== -->
                    <div id="loginView"
                         th:style="${mostrarRegistro != null and mostrarRegistro} ? 'display:none;' : 'display:block;'">

                        <div th:if="${param.error}" class="alert alert-danger py-2 px-3 small">
                            Usuario o contraseña incorrectos.
                        </div>

                        <div th:if="${param.disabled}" class="alert alert-warning py-2 px-3 small">
                            Tu cuenta se encuentra deshabilitada. Comunícate con el administrador.
                        </div>

                        <form id="loginForm"
                              th:action="@{/login}"
                              method="post"
                              autocomplete="on">

                            <input type="hidden"
                                   th:name="${_csrf.parameterName}"
                                   th:value="${_csrf.token}" />

                            <div class="mb-3">
                                <label class="form-label">Usuario o correo</label>
                                <input type="text"
                                       class="form-control"
                                       name="username"
                                       required
                                       minlength="3"
                                       maxlength="60"
                                       autocomplete="username">
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Contraseña</label>
                                <input type="password"
                                       class="form-control"
                                       name="password"
                                       required
                                       minlength="6"
                                       maxlength="60"
                                       autocomplete="current-password">
                            </div>

                            <button type="submit"
                                    class="btn btn-login w-100 mb-2">
                                Ingresar
                            </button>
                        </form>

                        <div class="d-flex align-items-center my-3">
                            <hr class="flex-grow-1">
                            <span class="mx-2 text-muted">o</span>
                            <hr class="flex-grow-1">
                        </div>

                        <a th:href="@{/oauth2/authorization/google}"
                           class="btn btn-login-google w-100 mb-2 d-flex align-items-center justify-content-center">

                            <img th:src="@{/images/google-logo.png}"
                                 alt="Google"
                                 style="height:20px;"
                                 class="me-2">

                            <span>Continuar con Google</span>
                        </a>

                        <div class="text-center mt-3">
                            <a href="#" onclick="mostrarRegistro(); return false;" style="font-size: 14px;">
                                ¿No tienes cuenta? Crear cuenta
                            </a>
                        </div>

                    </div>
                    <!-- FIN LOGIN -->

                    <!-- ============================== -->
                    <!--         VISTA REGISTRO         -->
                    <!-- ============================== -->
                    <div id="registroView"
                         th:style="${mostrarRegistro != null and mostrarRegistro} ? 'display:block;' : 'display:none;'">

                        <form id="registroForm"
                              th:object="${cliente}"
                              th:action="@{/registro-cliente}"
                              method="post"
                              autocomplete="off">

                            <input type="hidden"
                                   th:name="${_csrf.parameterName}"
                                   th:value="${_csrf.token}" />

                            <!-- CORREO -->
                            <div class="mb-3">
                                <label class="form-label">Correo</label>
                                <input type="email"
                                       class="form-control"
                                       th:field="*{correo}"
                                       maxlength="80"
                                       placeholder="correo@ejemplo.com">
                                <div th:errors="*{correo}" class="text-danger small"></div>
                            </div>

                            <!-- NOMBRES -->
                            <div class="mb-3">
                                <label class="form-label">Nombre</label>
                                <input type="text"
                                       class="form-control"
                                       th:field="*{nombres}">
                                <div th:errors="*{nombres}" class="text-danger small"></div>
                            </div>

                            <!-- APELLIDOS -->
                            <div class="mb-3">
                                <label class="form-label">Apellidos</label>
                                <input type="text"
                                       class="form-control"
                                       th:field="*{apellidos}">
                                <div th:errors="*{apellidos}" class="text-danger small"></div>
                            </div>

                            <!-- TIPO DOCUMENTO -->
                            <div class="mb-3">
                                <label class="form-label">Tipo de documento</label>
                                <select class="form-control"
                                        th:field="*{idTipoDocumento}">
                                    <option value="">-- Seleccione --</option>
                                    <option value="1">DNI</option>
                                    <option value="2">RUC</option>
                                </select>
                                <div th:errors="*{idTipoDocumento}" class="text-danger small"></div>
                            </div>

                            <!-- NÚMERO DOCUMENTO -->
                            <div class="mb-3">
                                <label class="form-label">N° documento</label>
                                <input type="text"
                                       class="form-control"
                                       th:field="*{nroDocumento}"
                                       maxlength="11"
                                       placeholder="DNI (8 dígitos) o RUC (11 dígitos)">
                                <div th:errors="*{nroDocumento}" class="text-danger small"></div>
                            </div>

                            <!-- CELULAR -->
                            <div class="mb-3">
                                <label class="form-label">Celular</label>
                                <input type="text"
                                       class="form-control"
                                       th:field="*{telefono}"
                                       maxlength="9"
                                       placeholder="Ej. 987654321">
                                <div th:errors="*{telefono}" class="text-danger small"></div>
                            </div>

                            <!-- CONTRASEÑA -->
                            <div class="mb-3">
                                <label class="form-label">Contraseña</label>
                                <input type="password"
                                       class="form-control"
                                       th:field="*{password}"
                                       minlength="6"
                                       maxlength="60"
                                       placeholder="Mínimo 6 caracteres">
                                <div th:errors="*{password}" class="text-danger small"></div>
                            </div>

                            <button type="submit" class="btn btn-login w-100 mb-2">
                                Registrarme
                            </button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="#" onclick="mostrarLogin(); return false;" style="font-size: 14px;">
                                ¿Ya tienes cuenta? Iniciar sesión
                            </a>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>

</div>

</body>
</html>
